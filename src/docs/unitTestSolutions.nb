(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     28843,        788]
NotebookOptionsPosition[     25549,        725]
NotebookOutlinePosition[     25945,        741]
CellTagsIndexPosition[     25902,        738]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.9495084568495417`*^9, 
  3.949508469021983*^9}},ExpressionUUID->"fc26722d-7023-48b8-85c1-\
46767d9cf480"],

Cell[CellGroupData[{

Cell["Stoichiometric coefficients", "Subsubsection",
 CellChangeTimes->{{3.949508391325492*^9, 
  3.949508444469901*^9}},ExpressionUUID->"1381253b-1cee-4677-9924-\
3ae5ff3f591b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s11", "->", 
      RowBox[{"-", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"s12", "->", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s13", "->", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s14", "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s15", "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s21", "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s22", "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"s23", "->", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"s24", "->", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"s25", "->", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kf1", "->", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kf2", "->", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"kr1", "->", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kr2", "->", 
      RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.949508267282798*^9, 3.949508311358677*^9}, {
   3.9495083497367477`*^9, 3.94950838545938*^9}, 3.949508484611622*^9, {
   3.949508692119485*^9, 3.9495087731819353`*^9}, {3.949509634551033*^9, 
   3.949509798898355*^9}, {3.949510212552845*^9, 3.949510286776422*^9}, 
   3.949510321286622*^9, {3.949516950757416*^9, 3.949516956027116*^9}, {
   3.949539815846404*^9, 3.949539819403913*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"f05eb77c-7421-427a-aa79-c3b5ccb04b2b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial concentrations", "Subsection",
 CellChangeTimes->{{3.9495084568495417`*^9, 3.949508469021983*^9}, {
  3.9495087949303913`*^9, 
  3.9495087982624683`*^9}},ExpressionUUID->"eb36e91f-06f8-4680-b0a7-\
05604cf51085"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c0", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"10.", "^", 
      RowBox[{"-", "16"}]}], ",", ".5", ",", "1.", ",", 
     RowBox[{"10.", "^", 
      RowBox[{"-", "16"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cinit", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c1", "->", 
      RowBox[{"c0", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"c2", "->", 
      RowBox[{"c0", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"c3", "->", 
      RowBox[{"c0", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", 
     RowBox[{"c4", "->", 
      RowBox[{"c0", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", 
     RowBox[{"c5", "->", 
      RowBox[{"c0", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.949508804613399*^9, 3.9495088235719633`*^9}, {
  3.9495159625813637`*^9, 3.949515973011286*^9}, {3.94951646308127*^9, 
  3.949516497429237*^9}, {3.9495170226720657`*^9, 3.949517064712237*^9}, {
  3.949517415239509*^9, 3.949517472214342*^9}, {3.950104163970237*^9, 
  3.9501041977054453`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"effab617-c8cb-4bd9-9fd9-e748f6e0df0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbolic Math", "Section",
 CellChangeTimes->{{3.949509007212892*^9, 
  3.94950902247628*^9}},ExpressionUUID->"e6fcff66-665b-4fac-bf98-\
e002eed40fab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"(", GridBox[{
      {"s11", "s12", "s13", "s14", "s15"},
      {"s21", "s22", "s23", "s24", "s25"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kf", "=", 
   RowBox[{"{", 
    RowBox[{"kf1", ",", "kf2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kr", "=", 
   RowBox[{"{", 
    RowBox[{"kr1", ",", "kr2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Xi]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Xi]1", ",", "\[Xi]2"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.949509029618278*^9, 3.949509111793108*^9}, {
  3.949509223326679*^9, 3.949509243668706*^9}, {3.949509433132827*^9, 
  3.9495094555773478`*^9}, {3.949517159140397*^9, 3.9495171770174017`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"846ea83c-dafa-44d9-9f09-382cf0c65a5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple Test System", "Section",
 CellChangeTimes->{{3.9495082568983383`*^9, 
  3.949508261839707*^9}},ExpressionUUID->"ddc1104c-460c-4b4e-9381-\
a177b6a320d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ForwardReactionProduct", "[", "r_", "]"}], ":=", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "^", 
           RowBox[{"-", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "j"}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "j"}], "]"}], "]"}], "<", "0"}]}], "}"}], 
        "}"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReverseReactionProduct", "[", "r_", "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"Piecewise", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "^", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", "j"}], "]"}], "]"}], ">", "0"}]}], "}"}], "}"}],
       ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.949508962989645*^9, 3.949508969793809*^9}, {
  3.949509123001677*^9, 3.949509219417609*^9}, {3.949509252383945*^9, 
  3.9495093025774937`*^9}, {3.9495093385256767`*^9, 3.949509338715643*^9}, {
  3.9495093823930597`*^9, 3.949509425094261*^9}, {3.94950946507862*^9, 
  3.9495094891955338`*^9}, {3.949510512176868*^9, 3.949510575291525*^9}, {
  3.949510845427495*^9, 3.9495108456733418`*^9}, {3.949510877756915*^9, 
  3.949510914510531*^9}, {3.949510945271747*^9, 3.949511030141487*^9}, {
  3.949511136020577*^9, 3.949511138361145*^9}, {3.9495112611089783`*^9, 
  3.949511264405383*^9}, {3.949511683275737*^9, 3.949511690271179*^9}, {
  3.9495117229463587`*^9, 3.9495117525512133`*^9}, {3.949511893731515*^9, 
  3.949511894383615*^9}, {3.949511933448835*^9, 3.9495119394350853`*^9}, {
  3.9495158296230717`*^9, 3.949515896844046*^9}, {3.949516212328989*^9, 
  3.9495162498683577`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"e46f0276-4342-4c1c-b197-a9ddda6a5659"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ForwardReactionProduct", "[", "1", "]"}], "/.", 
  "params"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReverseReactionProduct", "[", "1", "]"}], "/.", 
  "params"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ForwardReactionProduct", "[", "2", "]"}], "/.", 
  "params"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReverseReactionProduct", "[", "2", "]"}], "/.", 
  "params"}]}], "Input",
 CellChangeTimes->{{3.9495159274183826`*^9, 3.949515942382193*^9}, {
  3.949515976162763*^9, 3.949515992590516*^9}, {3.949516030671195*^9, 
  3.949516068940495*^9}, {3.949516840407926*^9, 3.94951687303489*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"dc1f4196-d69c-48fe-83b9-9d99d3eeacd6"],

Cell[BoxData[
 SuperscriptBox["c1", "2"]], "Output",
 CellChangeTimes->{
  3.949515942737005*^9, {3.949515977535975*^9, 3.949516069687181*^9}, {
   3.949516844947036*^9, 3.9495168734953117`*^9}, 3.9495173005576763`*^9, 
   3.949517379817993*^9, 3.949539824950844*^9, 3.950103968828392*^9, 
   3.950104200229663*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"914a311e-1db8-4adf-9170-fd6653f71cae"],

Cell[BoxData[
 RowBox[{"c2", " ", "c3"}]], "Output",
 CellChangeTimes->{
  3.949515942737005*^9, {3.949515977535975*^9, 3.949516069687181*^9}, {
   3.949516844947036*^9, 3.9495168734953117`*^9}, 3.9495173005576763`*^9, 
   3.949517379817993*^9, 3.949539824950844*^9, 3.950103968828392*^9, 
   3.9501042002302113`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"ee0e972b-2431-4fef-88bc-ed1968db6e0d"],

Cell[BoxData[
 RowBox[{"c3", " ", "c4"}]], "Output",
 CellChangeTimes->{
  3.949515942737005*^9, {3.949515977535975*^9, 3.949516069687181*^9}, {
   3.949516844947036*^9, 3.9495168734953117`*^9}, 3.9495173005576763`*^9, 
   3.949517379817993*^9, 3.949539824950844*^9, 3.950103968828392*^9, 
   3.9501042002307158`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"57d94a2b-9e8f-4673-938e-e026f8fba561"],

Cell[BoxData[
 SuperscriptBox["c5", "2"]], "Output",
 CellChangeTimes->{
  3.949515942737005*^9, {3.949515977535975*^9, 3.949516069687181*^9}, {
   3.949516844947036*^9, 3.9495168734953117`*^9}, 3.9495173005576763`*^9, 
   3.949517379817993*^9, 3.949539824950844*^9, 3.950103968828392*^9, 
   3.950104200231181*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"91a1283f-aac2-4785-9dcd-6d485251eeaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Residual0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"ForwardReactionProduct", "[", "1", "]"}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "1", "]"}], "]"}]], "*", 
       RowBox[{"ReverseReactionProduct", "[", "1", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"ForwardReactionProduct", "[", "2", "]"}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "2", "]"}], "]"}]], "*", 
       RowBox[{"ReverseReactionProduct", "[", "2", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Residual1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "1", "]"}], "]"}]], "*", 
       RowBox[{
        RowBox[{"ReverseReactionProduct", "[", "1", "]"}], "/", 
        RowBox[{"ForwardReactionProduct", "[", "1", "]"}]}]}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "2", "]"}], "]"}]], "*", 
       RowBox[{
        RowBox[{"ReverseReactionProduct", "[", "2", "]"}], "/", 
        RowBox[{"ForwardReactionProduct", "[", "2", "]"}]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Residual2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "1", "]"}], "]"}]], "*", 
       RowBox[{
        RowBox[{"ReverseReactionProduct", "[", "1", "]"}], "/", 
        RowBox[{"ForwardReactionProduct", "[", "1", "]"}]}]}], "]"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"kf", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"kr", "[", 
         RowBox[{"[", "2", "]"}], "]"}]], "*", 
       RowBox[{
        RowBox[{"ReverseReactionProduct", "[", "2", "]"}], "/", 
        RowBox[{"ForwardReactionProduct", "[", "2", "]"}]}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Residual0", "/.", "params"}], "/.", 
  "cinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Residual1", "/.", "params"}], "/.", 
  "cinit"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Residual2", "/.", "params"}], "/.", "cinit"}], ",", "14"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.949516296518321*^9, 3.9495164413191643`*^9}, 
   3.949516503730219*^9, {3.949516698922009*^9, 3.949516730827798*^9}, {
   3.950103949767248*^9, 3.950103963990991*^9}, {3.950105074394795*^9, 
   3.95010521026125*^9}, {3.950105296384161*^9, 3.950105304856518*^9}, 
   3.950105353843704*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"ce583507-97db-47b7-825b-ec0423889876"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "0.5`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9495169596812763`*^9, 3.949517300572939*^9, 3.949517379838773*^9, 
   3.949539824954954*^9, {3.950103965523238*^9, 3.950103968842927*^9}, {
   3.9501041819147797`*^9, 3.950104200241808*^9}, {3.950105191305937*^9, 
   3.950105210562668*^9}, 3.950105305708557*^9, 3.950105354368442*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"ca13a00d-96d2-4dc4-ace6-929c5c8b77fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9495169596812763`*^9, 3.949517300572939*^9, 3.949517379838773*^9, 
   3.949539824954954*^9, {3.950103965523238*^9, 3.950103968842927*^9}, {
   3.9501041819147797`*^9, 3.950104200241808*^9}, {3.950105191305937*^9, 
   3.950105210562668*^9}, 3.950105305708557*^9, 3.9501053543691607`*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"542e34dc-158e-43fd-ac70-ca5ec3218512"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "37.53450866846467448567636893130838871002`14."}], ",", 
   RowBox[{"-", "72.98957579524952166138973552733659744263`14."}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9495169596812763`*^9, 3.949517300572939*^9, 3.949517379838773*^9, 
   3.949539824954954*^9, {3.950103965523238*^9, 3.950103968842927*^9}, {
   3.9501041819147797`*^9, 3.950104200241808*^9}, {3.950105191305937*^9, 
   3.950105210562668*^9}, 3.950105305708557*^9, 3.9501053543698997`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"7b228b66-4da4-4eb3-a192-00f83396a978"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ResidualSub", "=", 
   RowBox[{"Residual", "/.", "params"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c\[Xi]", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"c0", "[", 
    RowBox[{"[", "i", "]"}], "]"}], "+", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"r", "=", "1"}], "2"], 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", 
       RowBox[{"r", ",", "i"}], "]"}], "]"}], 
     RowBox[{"\[Xi]", "[", 
      RowBox[{"[", "r", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c\[Xi]sub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c1", "->", 
      RowBox[{"c\[Xi]", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"c2", "->", 
      RowBox[{"c\[Xi]", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"c3", "->", 
      RowBox[{"c\[Xi]", "[", "3", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"c4", "->", 
      RowBox[{"c\[Xi]", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"c5", "->", 
      RowBox[{"c\[Xi]", "[", "5", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResidualSub0", "=", 
   RowBox[{
    RowBox[{"Residual0", "/.", "params"}], "/.", "c\[Xi]sub"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResidualSub1", "=", 
   RowBox[{
    RowBox[{"Residual1", "/.", "params"}], "/.", "c\[Xi]sub"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResidualSub2", "=", 
   RowBox[{
    RowBox[{"Residual2", "/.", "params"}], "/.", "c\[Xi]sub"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J0", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"ResidualSub1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J2", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"ResidualSub2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"ResidualSub2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"ResidualSub2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]1"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"ResidualSub2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "\[Xi]2"}], "]"}]}], "}"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"J0", "/.", "params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1", "->", "0"}], ",", 
     RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"J1", "/.", "params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1", "->", "0"}], ",", 
     RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"J2", "/.", "params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1", "->", "0"}], ",", 
     RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.949516631783876*^9, 3.94951663699189*^9}, {
  3.949516758542755*^9, 3.949516816764089*^9}, {3.949516891977007*^9, 
  3.949516935138673*^9}, {3.949517069562791*^9, 3.949517135408063*^9}, {
  3.949517185198084*^9, 3.949517211830289*^9}, {3.949517249294092*^9, 
  3.949517344438715*^9}, {3.949517500742958*^9, 3.949517835077269*^9}, {
  3.950105396646734*^9, 3.9501055425448637`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d3e0af00-4e21-4817-bcc0-bb4d630c4235"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "4.5`"}], "1.`*^-16"},
     {"1.`", 
      RowBox[{"-", "1.5000000000000004`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9495176440227613`*^9, 3.949517662928234*^9}, {
   3.9495177578621387`*^9, 3.9495177608034163`*^9}, {3.9495177920227737`*^9, 
   3.949517835438161*^9}, 3.9495398249645357`*^9, 3.950103968848098*^9, 
   3.950104048334957*^9, {3.950104185077179*^9, 3.950104200245109*^9}, {
   3.950105507035903*^9, 3.95010551672075*^9}, 3.9501055839366007`*^9},
 CellLabel->
  "Out[217]//MatrixForm=",ExpressionUUID->"6a4c730c-ffd5-4882-bbd6-\
9a8523f6151f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.5000000000000003`"}], "1.`*^-16"},
     {"3.9999999999999997`*^-32", 
      RowBox[{"-", "8.`*^-16"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9495176440227613`*^9, 3.949517662928234*^9}, {
   3.9495177578621387`*^9, 3.9495177608034163`*^9}, {3.9495177920227737`*^9, 
   3.949517835438161*^9}, 3.9495398249645357`*^9, 3.950103968848098*^9, 
   3.950104048334957*^9, {3.950104185077179*^9, 3.950104200245109*^9}, {
   3.950105507035903*^9, 3.95010551672075*^9}, 3.950105583937451*^9},
 CellLabel->
  "Out[218]//MatrixForm=",ExpressionUUID->"e00d3bd1-9dab-4549-bfb4-\
4e44df6d7fc1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000006`*^16", 
      RowBox[{"-", "2.`"}]},
     {
      RowBox[{"-", "2.`"}], "4.`*^16"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9495176440227613`*^9, 3.949517662928234*^9}, {
   3.9495177578621387`*^9, 3.9495177608034163`*^9}, {3.9495177920227737`*^9, 
   3.949517835438161*^9}, 3.9495398249645357`*^9, 3.950103968848098*^9, 
   3.950104048334957*^9, {3.950104185077179*^9, 3.950104200245109*^9}, {
   3.950105507035903*^9, 3.95010551672075*^9}, 3.950105583938238*^9},
 CellLabel->
  "Out[219]//MatrixForm=",ExpressionUUID->"d724d98d-bb04-4f58-9226-\
e5609cf152fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"J0", "/.", "params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1", "->", "0"}], ",", 
     RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.950105591811887*^9, 3.950105622220277*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"36b358e0-ab47-4d93-a5b4-bda93faff635"],

Cell["List(List(-4.5,1.e-16),List(1.,-1.5000000000000004))", "Output",
 CellChangeTimes->{{3.950105617056176*^9, 3.950105630247736*^9}},
 CellLabel->
  "Out[225]//CForm=",ExpressionUUID->"dbfcf283-093c-43c1-826d-5f11e32c6e52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CForm", "[", 
   RowBox[{
    RowBox[{"J1", "/.", "params"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Xi]1", "->", "0"}], ",", 
      RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.9501056250720453`*^9},
 CellLabel->
  "In[224]:=",ExpressionUUID->"84695981-9be5-4517-8618-14858cd51b02"],

Cell["\<\
List(List(-0.5000000000000003,1.e-16),List(3.9999999999999997e-32,-8.e-16))\
\>", "Output",
 CellChangeTimes->{3.950105627898889*^9},
 CellLabel->
  "Out[224]//CForm=",ExpressionUUID->"b075367c-b997-43c3-9dc3-c7835022bb2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"J2", "/.", "params"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1", "->", "0"}], ",", 
     RowBox[{"\[Xi]2", "->", "0"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[223]:=",ExpressionUUID->"64663dc3-c619-4ed2-b5ad-28737d4f86a8"],

Cell["List(List(1.0000000000000006e16,-2.),List(-2.,4.e16))", "Output",
 CellChangeTimes->{3.950105626776561*^9},
 CellLabel->
  "Out[223]//CForm=",ExpressionUUID->"727f80a4-919c-493b-9d1d-624fe75ef62c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 911},
WindowMargins->{{334, Automatic}, {Automatic, 276}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"59958113-fd28-4172-8c64-78d08b2f5464"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 160, 3, 53, "Subsection",ExpressionUUID->"fc26722d-7023-48b8-85c1-46767d9cf480"],
Cell[CellGroupData[{
Cell[761, 29, 178, 3, 43, "Subsubsection",ExpressionUUID->"1381253b-1cee-4677-9924-3ae5ff3f591b"],
Cell[942, 34, 1607, 32, 335, "Input",ExpressionUUID->"f05eb77c-7421-427a-aa79-c3b5ccb04b2b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2598, 72, 225, 4, 53, "Subsection",ExpressionUUID->"eb36e91f-06f8-4680-b0a7-05604cf51085"],
Cell[2826, 78, 1247, 34, 49, "Input",ExpressionUUID->"effab617-c8cb-4bd9-9fd9-e748f6e0df0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4110, 117, 157, 3, 66, "Section",ExpressionUUID->"e6fcff66-665b-4fac-bf98-e002eed40fab"],
Cell[4270, 122, 1019, 28, 125, "Input",ExpressionUUID->"846ea83c-dafa-44d9-9f09-382cf0c65a5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5326, 155, 165, 3, 66, "Section",ExpressionUUID->"ddc1104c-460c-4b4e-9381-a177b6a320d1"],
Cell[5494, 160, 2472, 62, 49, "Input",ExpressionUUID->"e46f0276-4342-4c1c-b197-a9ddda6a5659"],
Cell[CellGroupData[{
Cell[7991, 226, 727, 17, 90, "Input",ExpressionUUID->"dc1f4196-d69c-48fe-83b9-9d99d3eeacd6"],
Cell[8721, 245, 398, 8, 33, "Output",ExpressionUUID->"914a311e-1db8-4adf-9170-fd6653f71cae"],
Cell[9122, 255, 400, 8, 33, "Output",ExpressionUUID->"ee0e972b-2431-4fef-88bc-ed1968db6e0d"],
Cell[9525, 265, 400, 8, 33, "Output",ExpressionUUID->"57d94a2b-9e8f-4673-938e-e026f8fba561"],
Cell[9928, 275, 398, 8, 33, "Output",ExpressionUUID->"91a1283f-aac2-4785-9dcd-6d485251eeaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10363, 288, 3166, 91, 192, "Input",ExpressionUUID->"ce583507-97db-47b7-825b-ec0423889876"],
Cell[13532, 381, 470, 9, 33, "Output",ExpressionUUID->"ca13a00d-96d2-4dc4-ace6-929c5c8b77fb"],
Cell[14005, 392, 471, 9, 33, "Output",ExpressionUUID->"542e34dc-158e-43fd-ac70-ca5ec3218512"],
Cell[14479, 403, 596, 12, 33, "Output",ExpressionUUID->"7b228b66-4da4-4eb3-a192-00f83396a978"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15112, 420, 5459, 157, 568, "Input",ExpressionUUID->"d3e0af00-4e21-4817-bcc0-bb4d630c4235"],
Cell[20574, 579, 1018, 25, 61, "Output",ExpressionUUID->"6a4c730c-ffd5-4882-bbd6-9a8523f6151f"],
Cell[21595, 606, 1041, 25, 63, "Output",ExpressionUUID->"e00d3bd1-9dab-4549-bfb4-4e44df6d7fc1"],
Cell[22639, 633, 1018, 25, 63, "Output",ExpressionUUID->"d724d98d-bb04-4f58-9226-e5609cf152fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23694, 663, 375, 10, 29, "Input",ExpressionUUID->"36b358e0-ab47-4d93-a5b4-bda93faff635"],
Cell[24072, 675, 226, 3, 47, "Output",ExpressionUUID->"dbfcf283-093c-43c1-826d-5f11e32c6e52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24335, 683, 398, 12, 49, "Input",ExpressionUUID->"84695981-9be5-4517-8618-14858cd51b02"],
Cell[24736, 697, 233, 5, 47, "Output",ExpressionUUID->"b075367c-b997-43c3-9dc3-c7835022bb2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25006, 707, 309, 9, 29, "Input",ExpressionUUID->"64663dc3-c619-4ed2-b5ad-28737d4f86a8"],
Cell[25318, 718, 203, 3, 47, "Output",ExpressionUUID->"727f80a4-919c-493b-9d1d-624fe75ef62c"]
}, Open  ]]
}, Open  ]]
}
]
*)

